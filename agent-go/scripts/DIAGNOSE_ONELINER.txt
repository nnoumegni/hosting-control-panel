# One-liner to diagnose JetCamer Agent (run directly on the remote server)
#
# Copy and paste this entire command on the remote server:

echo "=== Comprehensive Agent Diagnosis ===" && echo "" && echo "1. ALL recent agent logs (last 50 lines):" && sudo journalctl -u jetcamer-agent --no-pager -n 50 && echo "" && echo "2. Errors and Warnings:" && sudo journalctl -u jetcamer-agent --no-pager | grep -iE 'error|warning|failed|fatal' | tail -20 && echo "" && echo "3. Running binary info:" && PID=$(pgrep jetcamer-agent | head -1) && if [ -n "$PID" ]; then echo "   Process PID: $PID" && echo "   Binary path: $(readlink -f /proc/$PID/exe 2>/dev/null || ps -p $PID -o cmd= | awk '{print $1}')" && echo "   Binary size: $(stat -c%s /opt/jetcamer-agent/jetcamer-agent 2>/dev/null || echo 'unknown')" && echo "   Binary modified: $(stat -c%y /opt/jetcamer-agent/jetcamer-agent 2>/dev/null || echo 'unknown')"; else echo "   âŒ Agent process not found"; fi && echo "" && echo "4. Agent health check:" && curl -s http://127.0.0.1:9811/health 2>&1 || echo 'Not responding' && echo "" && echo "5. Service status:" && sudo systemctl status jetcamer-agent --no-pager -l | head -20 && echo "" && echo "6. Looking for specific patterns:" && echo "   - 'JetCamer agent starting':" && sudo journalctl -u jetcamer-agent --no-pager | grep -i "jetcamer agent starting" | tail -1 || echo "      Not found" && echo "   - 'S3':" && sudo journalctl -u jetcamer-agent --no-pager | grep -i "s3" | tail -3 || echo "      Not found" && echo "   - 'batch sink':" && sudo journalctl -u jetcamer-agent --no-pager | grep -i "batch sink" | tail -3 || echo "      Not found" && echo "   - 'web server listening':" && sudo journalctl -u jetcamer-agent --no-pager | grep -i "web server listening" | tail -1 || echo "      Not found" && echo "" && echo "=== Diagnosis Complete ==="

